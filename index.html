<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>ç¥å¥‡çš„ç«‹æ–¹ä½“ - è¶£å‘³æ•°å­¦è¯¾</title>  
    <style>  
        body { margin: 0; overflow: hidden; font-family: 'Comic Sans MS', 'YouYuan', 'Microsoft YaHei', sans-serif; background-color: #E0F7FA; }  
          
        /* ä¾§è¾¹æ§åˆ¶æ  */  
        #sidebar {  
            position: absolute;  
            top: 0;  
            left: 0;  
            width: 320px;  
            height: 100vh;  
            background: rgba(255, 255, 255, 0.95);  
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);  
            padding: 20px;  
            box-sizing: border-box;  
            overflow-y: auto;  
            display: flex;  
            flex-direction: column;  
            gap: 15px;  
        }  
  
        h1 { color: #FF6B6B; text-align: center; font-size: 24px; margin-top: 0;}  
          
        /* ä»ªè¡¨ç›˜éƒ¨åˆ† */  
        .panel {  
            background: #fff;  
            border: 2px solid #B2EBF2;  
            border-radius: 15px;  
            padding: 15px;  
        }  
  
        .slider-group { display: flex; align-items: center; margin-bottom: 10px; }  
        .slider-group label { width: 50px; font-weight: bold; color: #555; }  
        input[type=range] { flex: 1; margin: 0 10px; cursor: pointer; }  
        .val-display { font-weight: bold; color: #0097A7; width: 20px; text-align: center; }  
  
        /* æŒ‰é’®æ ·å¼ */  
        .btn-grid {  
            display: grid;  
            grid-template-columns: 1fr 1fr;  
            gap: 10px;  
        }  
  
        button {  
            padding: 10px;  
            border: none;  
            border-radius: 10px;  
            cursor: pointer;  
            font-size: 16px;  
            font-weight: bold;  
            transition: all 0.2s;  
            color: white;  
        }  
  
        button:hover { transform: scale(1.05); }  
        button:active { transform: scale(0.95); }  
  
        .btn-face { background-color: #FF9800; }  
        .btn-edge { background-color: #4CAF50; }  
        .btn-vertex { background-color: #2196F3; }  
        .btn-reset { background-color: #9E9E9E; grid-column: span 2; }  
  
        /* æ•™å­¦ä¿¡æ¯æ˜¾ç¤º */  
        #info-box {  
            background: #FFF3E0;  
            border: 2px dashed #FFB74D;  
            padding: 15px;  
            border-radius: 10px;  
            font-size: 16px;  
            line-height: 1.5;  
            min-height: 100px;  
        }  
  
        .highlight { color: #D84315; font-weight: bold; font-size: 18px; }  
          
        /* ä½“ç§¯è®¡ç®—å…¬å¼å±•ç¤º */  
        #math-box {  
            text-align: center;  
            font-size: 20px;  
            background: #E8F5E9;  
            padding: 10px;  
            border-radius: 10px;  
            border: 2px solid #4CAF50;  
        }  
          
        .math-formula { font-size: 24px; font-weight: bold; color: #2E7D32; }  
  
    </style>  
    <script type="importmap">  
        {  
            "imports": {  
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",  
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"  
            }  
        }  
    </script>  
</head>  
<body>  
  
    <div id="sidebar">  
        <h1>ğŸ§Š ç«‹æ–¹ä½“å¤§è§£å‰–</h1>  
          
        <!-- å°ºå¯¸æ§åˆ¶ -->  
        <div class="panel">  
            <p style="margin-top:0; font-weight:bold; color:#666;">1. æ”¹å˜å½¢çŠ¶ (é•¿å®½é«˜)</p>  
            <div class="slider-group">  
                <label>é•¿:</label>  
                <input type="range" id="rangeL" min="1" max="6" value="3">  
                <span class="val-display" id="valL">3</span>  
            </div>  
            <div class="slider-group">  
                <label>å®½:</label>  
                <input type="range" id="rangeW" min="1" max="6" value="2">  
                <span class="val-display" id="valW">2</span>  
            </div>  
            <div class="slider-group">  
                <label>é«˜:</label>  
                <input type="range" id="rangeH" min="1" max="6" value="3">  
                <span class="val-display" id="valH">3</span>  
            </div>  
        </div>  
  
        <!-- ç»“æ„æ•™å­¦æŒ‰é’® -->  
        <div class="panel">  
            <p style="margin-top:0; font-weight:bold; color:#666;">2. è®¤è¯†ç»“æ„ (ç‚¹è¿™é‡Œ!)</p>  
            <div class="btn-grid">  
                <button class="btn-vertex" id="btnVertex">ğŸ”µ é¡¶ç‚¹</button>  
                <button class="btn-edge" id="btnEdge">ğŸŸ¢ æ£± (è¾¹)</button>  
                <button class="btn-face" id="btnFace">ğŸŸ  é¢</button>  
                <button class="btn-reset" id="btnReset">ğŸ‘ï¸ä¸ä»…çœ‹ç»“æ„ï¼Œçœ‹ä½“ç§¯</button>  
            </div>  
        </div>  
  
        <!-- ä¿¡æ¯å±•ç¤º -->  
        <div id="info-box">  
            ğŸ‘‹ å—¨ï¼æˆ‘æ˜¯å°ç«‹æ–¹ã€‚<br>  
            æ‹–åŠ¨æ»‘å—æ”¹å˜æˆ‘çš„èº«æï¼Œç‚¹å‡»æŒ‰é’®è®¤è¯†æˆ‘çš„èº«ä½“æ„é€ å§ï¼  
        </div>  
  
        <!-- ä½“ç§¯å…¬å¼ -->  
        <div id="math-box">  
            <div>ä½“ç§¯å…¬å¼: é•¿ Ã— å®½ Ã— é«˜</div>  
            <div class="math-formula" id="formula">3 Ã— 2 Ã— 3 = 18</div>  
            <div style="font-size: 14px; color: #666;">(ä¹Ÿå°±æ˜¯æœ‰ 18 ä¸ªå°æ–¹å—)</div>  
        </div>  
    </div>  
  
    <script type="module">  
        import * as THREE from 'three';  
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';  
  
        // --- 1. åœºæ™¯åˆå§‹åŒ– ---  
        const scene = new THREE.Scene();  
        scene.background = new THREE.Color(0xE0F7FA);  
  
        const camera = new THREE.PerspectiveCamera(45, (window.innerWidth - 320) / window.innerHeight, 0.1, 100);  
        camera.position.set(8, 8, 12);  
  
        const renderer = new THREE.WebGLRenderer({ antialias: true });  
        renderer.setSize(window.innerWidth - 320, window.innerHeight);  
        renderer.shadowMap.enabled = true;  
        document.body.appendChild(renderer.domElement);  
          
        // è°ƒæ•´ canvas ä½ç½®åˆ°å³ä¾§  
        renderer.domElement.style.position = 'absolute';  
        renderer.domElement.style.right = '0';  
        renderer.domElement.style.top = '0';  
  
        // ç¯å…‰  
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);  
        scene.add(ambientLight);  
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);  
        dirLight.position.set(5, 10, 7);  
        dirLight.castShadow = true;  
        scene.add(dirLight);  
  
        // æ§åˆ¶å™¨  
        const controls = new OrbitControls(camera, renderer.domElement);  
        controls.enableDamping = true;  
  
        // åœ°é¢ç½‘æ ¼  
        const gridHelper = new THREE.GridHelper(20, 20, 0x888888, 0xbbbbbb);  
        scene.add(gridHelper);  
  
        // --- 2. æ ¸å¿ƒé€»è¾‘å˜é‡ ---  
        let currentL = 3;  
        let currentW = 2;  
        let currentH = 3;  
          
        // å­˜å‚¨3Då¯¹è±¡çš„ç»„  
        const mainGroup = new THREE.Group(); // å­˜æ”¾æ‰€æœ‰æ–¹å—  
        const highlightGroup = new THREE.Group(); // å­˜æ”¾é«˜äº®éƒ¨ä»¶  
        scene.add(mainGroup);  
        scene.add(highlightGroup);  
  
        // --- 3. åŠŸèƒ½å‡½æ•° ---  
  
        // åˆ›å»ºç§¯æœ¨å † (å±•ç¤ºä½“ç§¯)  
        function createBlocks(L, W, H) {  
            // æ¸…ç©ºæ—§çš„  
            while(mainGroup.children.length > 0){   
                mainGroup.remove(mainGroup.children[0]);   
            }  
  
            const geometry = new THREE.BoxGeometry(0.95, 0.95, 0.95); // ç¨å¾®ç•™ç¼éš™ï¼Œæ–¹ä¾¿æ•°æ•°  
            const material = new THREE.MeshStandardMaterial({   
                color: 0xFFEB3B,   
                roughness: 0.1,  
                metalness: 0.1  
            });  
  
            // ä¸ºäº†è®©æ–¹å—ä¸­å¿ƒåœ¨åŸç‚¹é™„è¿‘ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—åç§»é‡  
            const offsetX = (L - 1) / 2;  
            const offsetY = (H - 1) / 2;  
            const offsetZ = (W - 1) / 2; // æ³¨æ„ï¼šZè½´å¯¹åº”å®½  
  
            for (let x = 0; x < L; x++) {  
                for (let y = 0; y < H; y++) {  
                    for (let z = 0; z < W; z++) {  
                        const cube = new THREE.Mesh(geometry, material);  
                        // æ‘†æ”¾ä½ç½® (ä»åœ°é¢å‘ä¸Š)  
                        cube.position.set(x - offsetX, y + 0.5, z - offsetZ);  
                          
                        // ç»™æ¯ä¸ªæ–¹å—åŠ ä¸ªé»‘è‰²è¾¹æ¡†ï¼Œè¿™æ ·æ•°èµ·æ¥æ›´æ¸…æ¥š  
                        const edges = new THREE.EdgesGeometry(geometry);  
                        const line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial( { color: 0xD3A600 } ) );  
                        cube.add(line);  
                          
                        cube.castShadow = true;  
                        cube.receiveShadow = true;  
                        mainGroup.add(cube);  
                    }  
                }  
            }  
              
            // è°ƒæ•´ç›¸æœºä¸­å¿ƒ  
            controls.target.set(0, H/2, 0);  
        }  
  
        // åˆ›å»ºé«˜äº®ç»“æ„ (é¢ã€æ£±ã€é¡¶ç‚¹)  
        function showStructure(type) {  
            highlightGroup.clear();  
            const L = currentL;  
            const W = currentW; // Zè½´  
            const H = currentH;  
  
            const halfL = L / 2;  
            const halfH = H / 2;  
            const halfW = W / 2;  
            const centerY = H / 2;  
  
            if (type === 'vertex') {  
                // åˆ›å»º8ä¸ªé¡¶ç‚¹  
                const sphereGeo = new THREE.SphereGeometry(0.25, 16, 16);  
                const sphereMat = new THREE.MeshStandardMaterial({ color: 0x2196F3, emissive: 0x1565C0 });  
                  
                const corners = [  
                    [-halfL, 0, -halfW], [halfL, 0, -halfW], [-halfL, H, -halfW], [halfL, H, -halfW],  
                    [-halfL, 0, halfW], [halfL, 0, halfW], [-halfL, H, halfW], [halfL, H, halfW]  
                ];  
  
                corners.forEach(pos => {  
                    const sphere = new THREE.Mesh(sphereGeo, sphereMat);  
                    sphere.position.set(pos[0], pos[1], pos[2]);  
                    highlightGroup.add(sphere);  
                });  
                updateInfo(`ğŸ”µ <b>é¡¶ç‚¹ (Vertex)</b><br>çœ‹é‚£äº›è“è‰²çš„å°çƒï¼<br>ç«‹æ–¹ä½“ä¸€å…±æœ‰ <span class="highlight">8</span> ä¸ªé¡¶ç‚¹ã€‚<br>å®ƒä»¬æ˜¯è§’å°–å°–çš„åœ°æ–¹ã€‚`);  
            }  
            else if (type === 'edge') {  
                // åˆ›å»º12æ¡æ£±  
                const edgeMat = new THREE.MeshStandardMaterial({ color: 0x4CAF50, emissive: 0x2E7D32 });  
                const radius = 0.08;  
  
                // è¾…åŠ©å‡½æ•°ï¼šç”»åœ†æŸ±  
                function createBar(len, x, y, z, rotAxis) {  
                    const geo = new THREE.CylinderGeometry(radius, radius, len, 8);  
                    const bar = new THREE.Mesh(geo, edgeMat);  
                    bar.position.set(x, y, z);  
                    if (rotAxis === 'z') bar.rotation.x = Math.PI / 2;  
                    if (rotAxis === 'x') bar.rotation.z = Math.PI / 2;  
                    highlightGroup.add(bar);  
                }  
  
                // 4æ¡é«˜ (Yè½´)  
                createBar(H, -halfL, centerY, -halfW, 'y');  
                createBar(H, halfL, centerY, -halfW, 'y');  
                createBar(H, -halfL, centerY, halfW, 'y');  
                createBar(H, halfL, centerY, halfW, 'y');  
                  
                // 4æ¡é•¿ (Xè½´)  
                createBar(L, 0, 0, -halfW, 'x');  
                createBar(L, 0, H, -halfW, 'x');  
                createBar(L, 0, 0, halfW, 'x');  
                createBar(L, 0, H, halfW, 'x');  
  
                // 4æ¡å®½ (Zè½´)  
                createBar(W, -halfL, 0, 0, 'z');  
                createBar(W, halfL, 0, 0, 'z');  
                createBar(W, -halfL, H, 0, 'z');  
                createBar(W, halfL, H, 0, 'z');  
  
                updateInfo(`ğŸŸ¢ <b>æ£± (Edge)</b><br>çœ‹è¿™äº›ç»¿è‰²çš„æ£’å­ï¼<br>ç«‹æ–¹ä½“ä¸€å…±æœ‰ <span class="highlight">12</span> æ¡æ£±ã€‚<br>å®ƒä»¬æ˜¯é¢å’Œé¢è¿æ¥çš„çº¿ã€‚`);  
            }  
            else if (type === 'face') {  
                // åˆ›å»º6ä¸ªé¢  
                const faceMat = new THREE.MeshBasicMaterial({   
                    color: 0xFF9800,   
                    transparent: true,   
                    opacity: 0.4,  
                    side: THREE.DoubleSide  
                });  
  
                function createPlane(w, h, x, y, z, rotX, rotY) {  
                    const geo = new THREE.PlaneGeometry(w, h);  
                    const plane = new THREE.Mesh(geo, faceMat);  
                    plane.position.set(x, y, z);  
                    if(rotX) plane.rotation.x = rotX;  
                    if(rotY) plane.rotation.y = rotY;  
                    // åŠ ä¸€ä¸ªè¾¹æ¡†  
                    const border = new THREE.LineSegments(new THREE.EdgesGeometry(geo), new THREE.LineBasicMaterial({color:0xFF6D00}));  
                    plane.add(border);  
                    highlightGroup.add(plane);  
                }  
  
                // å‰å (Z)  
                createPlane(L, H, 0, centerY, halfW + 0.01, 0, 0);  
                createPlane(L, H, 0, centerY, -halfW - 0.01, 0, 0);  
                // å·¦å³ (X)  
                createPlane(W, H, -halfL - 0.01, centerY, 0, 0, Math.PI/2);  
                createPlane(W, H, halfL + 0.01, centerY, 0, 0, Math.PI/2);  
                // ä¸Šä¸‹ (Y)  
                createPlane(L, W, 0, H + 0.01, 0, Math.PI/2, 0);  
                createPlane(L, W, 0, 0 - 0.01, 0, Math.PI/2, 0);  
  
                updateInfo(`ğŸŸ  <b>é¢ (Face)</b><br>çœ‹è¿™äº›æ©˜è‰²çš„ç»ç’ƒç‰‡ï¼<br>ç«‹æ–¹ä½“ä¸€å…±æœ‰ <span class="highlight">6</span> ä¸ªé¢ã€‚<br>å®ƒä»¬æ˜¯å¹³å¹³çš„è¡¨é¢ã€‚`);  
            }  
        }  
  
        function updateInfo(html) {  
            document.getElementById('info-box').innerHTML = html;  
        }  
  
        function updateAll() {  
            // 1. æ›´æ–°æ–‡æœ¬  
            document.getElementById('valL').innerText = currentL;  
            document.getElementById('valW').innerText = currentW;  
            document.getElementById('valH').innerText = currentH;  
              
            const volume = currentL * currentW * currentH;  
            document.getElementById('formula').innerText = `$${currentL} Ã— $${currentW} Ã— $${currentH} = $${volume}`;  
  
            // 2. é‡æ–°ç”Ÿæˆç§¯æœ¨  
            createBlocks(currentL, currentW, currentH);  
              
            // 3. å¦‚æœæœ‰é«˜äº®ï¼Œæ¸…é™¤æ‰ï¼Œå›åˆ°é»˜è®¤çŠ¶æ€  
            highlightGroup.clear();  
            document.getElementById('info-box').innerHTML = "ğŸ“¦ å½¢çŠ¶å˜å•¦ï¼<br>ä½ å¯ä»¥æ•°ä¸€æ•°ï¼Œç°åœ¨ä¸€å…±æœ‰ <span class='highlight'>" + volume + "</span> ä¸ªå°ç§¯æœ¨å“¦ã€‚<br>è¿™å°±å« <b>ä½“ç§¯</b>ã€‚";  
        }  
  
        // --- 4. äº‹ä»¶ç›‘å¬ ---  
          
        document.getElementById('rangeL').addEventListener('input', (e) => { currentL = parseInt(e.target.value); updateAll(); });  
        document.getElementById('rangeW').addEventListener('input', (e) => { currentW = parseInt(e.target.value); updateAll(); });  
        document.getElementById('rangeH').addEventListener('input', (e) => { currentH = parseInt(e.target.value); updateAll(); });  
  
        document.getElementById('btnVertex').addEventListener('click', () => showStructure('vertex'));  
        document.getElementById('btnEdge').addEventListener('click', () => showStructure('edge'));  
        document.getElementById('btnFace').addEventListener('click', () => showStructure('face'));  
        document.getElementById('btnReset').addEventListener('click', () => {  
            highlightGroup.clear();  
            updateInfo("âœ¨ å˜å›ç§¯æœ¨æ¨¡å¼ï¼<br>æ¯ä¸ªå°é»„å—ä»£è¡¨ä½“ç§¯ä¸º 1 çš„å•ä½ã€‚<br>æ€»æ•°å°±æ˜¯ä½“ç§¯ã€‚");  
        });  
  
        window.addEventListener('resize', () => {  
            camera.aspect = (window.innerWidth - 320) / window.innerHeight;  
            camera.updateProjectionMatrix();  
            renderer.setSize(window.innerWidth - 320, window.innerHeight);  
        });  
  
        // --- 5. å¯åŠ¨ ---  
        updateAll();  
  
        function animate() {  
            requestAnimationFrame(animate);  
            controls.update();  
              
            // è®©é«˜äº®éƒ¨åˆ†ç¨å¾®åŠ¨ä¸€ä¸‹ï¼Œå¸å¼•æ³¨æ„åŠ›  
            if (highlightGroup.children.length > 0) {  
                // ç®€å•çš„å‘¼å¸æ•ˆæœ  
                const scale = 1 + Math.sin(Date.now() * 0.005) * 0.02;  
                highlightGroup.scale.set(scale, scale, scale);  
            }  
  
            renderer.render(scene, camera);  
        }  
        animate();  
  
    </script>  
</body>  
</html>  
